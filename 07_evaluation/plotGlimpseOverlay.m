% plot time-frequency representation of period glimpses of mixed signal and
% of target/interferer signal (for DAGA)
function [] = plotGlimpseOverlay(testSignal, samplingRateHz, timeVec, nBands,...
    separateSampleIndices, mixedSampleIndices, p0SearchRangeFreqVector,...
    separatep0DetectedIndexVectors, mixedp0DetectedIndexVectors, separateString)
    meanTestSignal = (testSignal(:,1) + testSignal(:,2))./2;
    figure;
    winlen = 2000;
    overlap = round(winlen-500);%kaiser5 *0.705);%blackmanharris *0.661);
%     spectrogram(meanTestSignal,blackmanharris(winlen),overlap,[],...
%         samplingRateHz,'yaxis');
    ylim([0, 0.5]);
    shading interp;
    title(['signal spectrogram, winlen=',num2str(winlen),', overlap=',num2str(overlap)])
    hold on;
    for iBand = 1:nBands%7
        scatter(timeVec(separateSampleIndices.L{iBand}), ...
            1e-3.*p0SearchRangeFreqVector(separatep0DetectedIndexVectors.L{iBand}), ...
            15, 'red','filled');
        scatter(timeVec(mixedSampleIndices.L{iBand}), ...
            1e-3.*p0SearchRangeFreqVector(mixedp0DetectedIndexVectors.L{iBand}), ...
            10, 'black','filled');
        
        scatter(timeVec(separateSampleIndices.R{iBand}), ...
            1e-3.*p0SearchRangeFreqVector(separatep0DetectedIndexVectors.R{iBand}), ...
            15, 'red','filled');
        scatter(timeVec(mixedSampleIndices.R{iBand}), ...
            1e-3.*p0SearchRangeFreqVector(mixedp0DetectedIndexVectors.R{iBand}), ...
            10, 'black','filled');
        legend(['glimpses from ',separateString,' signal'], 'glimpses from mixed signal')
    end
end